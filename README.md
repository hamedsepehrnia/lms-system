# ุณุณุชู ูุฏุฑุช ุงุฏฺฏุฑ ุขููุงู (LMS) - ูพุงุง ูุงู

ุณุณุชู ฺฉุงูู ูุฏุฑุช ุงุฏฺฏุฑ ุขููุงู ุจุง ุงุญุฑุงุฒ ููุช ูุจุชู ุจุฑ ุณุดู ู ูพุฑุฏุงุฎุช Zarinpal.

## ูฺฺฏโูุง

- โ ุงุญุฑุงุฒ ููุช ูุจุชู ุจุฑ ุณุดู (Session-based)
- โ ูุฑูุฏ ุจุง ุดูุงุฑู ุชููู ู OTP (Kavenegar)
- โ ูพุฑุฏุงุฎุช ุขููุงู ุจุง Zarinpal
- โ ูุฏุฑุช ุฏูุฑูโูุง ู ุฏุฑูุณ
- โ ุชููุฏ ฺฏูุงููุงูู PDF ุจุง ูููุช ูุงุฑุณ
- โ ููุดโูุง ฺฉุงุฑุจุฑ: ADMIN, INSTRUCTOR, STUDENT
- โ ูุณุชูุฏุงุช ฺฉุงูู Swagger
- โ CLI Tool ุจุฑุง ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู

## ูพุดโูุงุฒูุง

- Node.js 20+
- PostgreSQL 16+
- Docker & Docker Compose (ุงุฎุชุงุฑ)

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### 1. ฺฉููู ฺฉุฑุฏู ูพุฑูฺู

```bash
git clone <repository-url>
cd "paya life new pg"
```

### 2. ูุตุจ ูุงุจุณุชฺฏโูุง

```bash
npm install
```

### 3. ุฑุงูโุงูุฏุงุฒ ุฏุชุงุจุณ

```bash
docker-compose up -d
```

ุง ุงุณุชูุงุฏู ุงุฒ PostgreSQL ููุฌูุฏ ู ุชูุธู `DATABASE_URL` ุฏุฑ `.env`

### 4. ุชูุธู ูุชุบุฑูุง ูุญุท

ูุงู `.env.example` ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุจู `.env` ุชุบุฑ ูุงู ุฏูุฏ:

```bash
cp .env.example .env
```

ุณูพุณ ููุงุฏุฑ ุฑุง ุชูุธู ฺฉูุฏ:

```env
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/paya_life_lms?schema=public
SESSION_SECRET=your-super-secret-session-key-change-in-production
KAVENEGAR_API_KEY=your-kavenegar-api-key
ZARINPAL_MERCHANT_ID=your-zarinpal-merchant-id

# ุญุงูุช Debug ุจุฑุง OTP (ุจุฑุง ุชูุณุนู)
# ุงฺฏุฑ true ุจุงุดุฏุ ฺฉุฏ OTP ุฏุฑ ุชุฑููุงู ููุงุด ุฏุงุฏู ูโุดูุฏ (ุจุฏูู ุงุฑุณุงู ูพุงูฺฉ)
OTP_DEBUG_MODE=true
```

### 5. ุงุฌุฑุง Migration

```bash
npm run prisma:generate
npm run prisma:migrate
```

### 6. ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู

ุจุฑุง ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู ุงุฒ CLI tool ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
npm run createadmin
```

ุงู ุฏุณุชูุฑ ุงุฒ ุดูุง ุดูุงุฑู ุชููู ู ูุงู ุฑุง ูโูพุฑุณุฏ ู ฺฉุงุฑุจุฑ ุฑุง ุจุง ููุด ADMIN ุงุฌุงุฏ ูโฺฉูุฏ.

**ูุซุงู:**
```
ุดูุงุฑู ุชููู (09xxxxxxxxx): 09123456789
ูุงู: ุงุฏูู ุงุตู
```

ุจุนุฏ ุงุฒ ุงุฌุงุฏุ ูโุชูุงูุฏ ุจุง ููุงู ุดูุงุฑู ุชููู ู ุฑูุด OTP ุนุงุฏ ูุงุฑุฏ ุณุณุชู ุดูุฏ.

### 7. Seed ฺฉุฑุฏู ุฏุชุงุจุณ (ุงุฎุชุงุฑ)

```bash
npm run seed
```

ุงู ุฏุณุชูุฑ ฺฉ ุงุฏูู (09121234567)ุ 3 ุฏุณุชูโุจูุฏ ู ฺฉ ุฏูุฑู ููููู ุงุฌุงุฏ ูโฺฉูุฏ.

### 8. ุงุฌุฑุง ุณุฑูุฑ

```bash
npm run dev
```

ุณุฑูุฑ ุฑู `http://localhost:3000` ุงุฌุฑุง ูโุดูุฏ.

## ุฏุณุชุฑุณโูุง

### ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู

ุงุฒ CLI tool ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
npm run createadmin
```

## API Documentation

ูุณุชูุฏุงุช ฺฉุงูู API ุฏุฑ ุขุฏุฑุณ ุฒุฑ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช:

```
http://localhost:3000/api-docs
```

## ุณุงุฎุชุงุฑ ูพุฑูฺู

```
src/
โโโ cli/              # CLI Tools (createadmin)
โโโ controllers/      # ฺฉูุชุฑูุฑูุง API
โโโ middleware/       # ูุฏููุฑูุง (auth, role, multer)
โโโ routes/          # Route handlers
โโโ services/        # ุณุฑูุณโูุง ุฎุงุฑุฌ (Kavenegar, Zarinpal, PDF)
โโโ utils/           # ุชูุงุจุน ฺฉูฺฉ
โโโ prisma/          # Prisma schema
โโโ app.js           # ุชูุธูุงุช Express
โโโ server.js        # ููุทู ูุฑูุฏ ุณุฑูุฑ
โโโ seed.js          # Seed script
```

## API Routes

### ุนููู
- `POST /api/v1/auth/send-otp` - ุงุฑุณุงู OTP
- `POST /api/v1/auth/verify-otp` - ุชุงุฏ OTP
- `GET /api/v1/courses` - ูุณุช ุฏูุฑูโูุง
- `GET /api/v1/courses/:slug` - ุฌุฒุฆุงุช ุฏูุฑู
- `GET /api/v1/categories` - ูุณุช ุฏุณุชูโุจูุฏโูุง

### ฺฉุงุฑุจุฑ (ูุงุฒ ุจู ุณุดู)
- `GET /api/v1/me` - ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
- `PATCH /api/v1/me` - ุจูโุฑูุฒุฑุณุงู ูพุฑููุงู
- `GET /api/v1/my/courses` - ุฏูุฑูโูุง ูู
- `POST /api/v1/courses/:slug/enroll` - ุซุจุชโูุงู ุฏุฑ ุฏูุฑู
- `POST /api/v1/progress` - ุซุจุช ูพุดุฑูุช
- `GET /api/v1/certificates` - ฺฏูุงููุงููโูุง ูู
- `GET /api/v1/certificates/:id/download` - ุฏุงูููุฏ ฺฏูุงููุงูู

### ูุฏุฑุณ
- `POST /api/v1/instructor/request` - ุฏุฑุฎูุงุณุช ูุฏุฑุณ ุดุฏู
- `GET /api/v1/instructor/my-courses` - ุฏูุฑูโูุง ูุฏุฑุณ
- `POST /api/v1/instructor/courses` - ุงุฌุงุฏ ุฏูุฑู
- `PATCH /api/v1/instructor/courses/:id` - ุจูโุฑูุฒุฑุณุงู ุฏูุฑู
- `POST /api/v1/instructor/courses/:id/lessons` - ุงูุฒูุฏู ุฏุฑุณ
- `GET /api/v1/instructor/sales-report` - ฺฏุฒุงุฑุด ูุฑูุด

### ุงุฏูู
- `GET /api/v1/admin/dashboard` - ุขูุงุฑ ุณุณุชู
- `GET /api/v1/admin/instructor-requests` - ุฏุฑุฎูุงุณุชโูุง ูุฏุฑุณ
- `PATCH /api/v1/admin/instructor-requests/:id` - ุชุงุฏ/ุฑุฏ ุฏุฑุฎูุงุณุช
- `PATCH /api/v1/admin/courses/:id/publish` - ุงูุชุดุงุฑ ุฏูุฑู
- `POST /api/v1/admin/categories` - ุงุฌุงุฏ ุฏุณุชูโุจูุฏ
- `PATCH /api/v1/admin/categories/:id` - ุจูโุฑูุฒุฑุณุงู ุฏุณุชูโุจูุฏ
- `DELETE /api/v1/admin/categories/:id` - ุญุฐู ุฏุณุชูโุจูุฏ

## CLI Commands

### ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู

```bash
npm run createadmin
```

ุงู ุฏุณุชูุฑ ฺฉ CLI interactive ุงุฌุฑุง ูโฺฉูุฏ ฺฉู:
- ุดูุงุฑู ุชููู ุฑุง ูโูพุฑุณุฏ (ุจุง validation)
- ูุงู ุฑุง ูโูพุฑุณุฏ (ุจุง validation)
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุฑู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ฺฏุฒูู ุชุจุฏู ุจู ADMIN ุง ุจูโุฑูุฒุฑุณุงู ูุงู ุฑุง ูโุฏูุฏ
- ฺฉุงุฑุจุฑ ุฑุง ุจุง ููุด ADMIN ุงุฌุงุฏ ูโฺฉูุฏ
- ุจุนุฏ ุงุฒ ุงุฌุงุฏุ ูโุชูุงูุฏ ุจุง ููุงู ุดูุงุฑู ู ุฑูุด OTP ุนุงุฏ ูุงุฑุฏ ุดูุฏ

## ุญุงูุช Debug ุจุฑุง OTP

ุจุฑุง ุชูุณุนู ู ุชุณุชุ ูโุชูุงูุฏ ุงุฒ ุญุงูุช Debug ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ฺฉุฏ OTP ุฑุง ุฏุฑ ุชุฑููุงู ููุงุด ูโุฏูุฏ ุจู ุฌุง ุงุฑุณุงู ูพุงูฺฉ ูุงูุน.

ุฏุฑ ูุงู `.env`:

```env
OTP_DEBUG_MODE=true
```

ููุช ุงู ูุชุบุฑ `true` ุจุงุดุฏ:
- โ ฺฉุฏ OTP ุฏุฑ ุชุฑููุงู ููุงุด ุฏุงุฏู ูโุดูุฏ
- โ ูพุงูฺฉ ูุงูุน ุงุฑุณุงู ููโุดูุฏ
- โ ูุงุฒ ุจู API Key Kavenegar ูุณุช
- โ ุจุฑุง ุชุณุช ู ุชูุณุนู ููุงุณุจ ุงุณุช

**ูุซุงู ุฎุฑูุฌ ุฏุฑ ุชุฑููุงู:**
```
============================================================
๐ฑ DEBUG MODE - OTP Code (ูพุงูฺฉ ุงุฑุณุงู ูุดุฏ)
============================================================
๐ ุดูุงุฑู ุชููู: 09123456789
๐ ฺฉุฏ ุชุงุฏ: 123456
โฐ ูุฏุช ุงุนุชุจุงุฑ: 120 ุซุงูู
============================================================
```

โ๏ธ **ุชูุฌู:** ุฏุฑ Production ุญุชูุงู `OTP_DEBUG_MODE=false` ุชูุธู ฺฉูุฏ.

## ุชฺฉููููฺโูุง

- **Node.js** - Runtime
- **Express.js** - Web Framework
- **PostgreSQL** - Database
- **Prisma** - ORM
- **express-session** - Session Management
- **Kavenegar** - SMS Service
- **Zarinpal** - Payment Gateway
- **Multer** - File Upload
- **PDFKit** - PDF Generation
- **Swagger** - API Documentation

## ูุงุณูุณ

ISC
